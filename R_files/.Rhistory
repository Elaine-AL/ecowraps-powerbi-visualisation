knitr::opts_chunk$set(echo = TRUE)
#Load the necessary libraries
library(DBI)
library(RPostgres)
#Load the necessary libraries
library(DBI)
install.packages(DBI)
install.packages(c("DBI", "RPostgres", "readxl", "dplyr"))
#Load the necessary libraries
#install.packages(c("DBI", "RPostgres", "readxl", "dplyr"))
library(DBI)
library(RPostgres)
library(readxl)
library(dplyr)
excel_file <- "C:/Users/Public/Documents/EcoWraps.xlsx"
sheet_names <- excel_sheets(excel_file)
sheet_names
typeof(sheet_names)
# Get all sheet names and select the ones you want
sheet_names <- excel_sheets(excel_file) %>%
select(c("Initial stock", "Purchases", "Daily sales", "Stock", "Daily expenses"))
sheet_names <- excel_sheets(excel_file) %>%
intersect(c("Initial stock", "Purchases", "Daily sales", "Stock", "Daily expenses"))
sheet_names
# Path to your Excel file
excel_file <- "C:/Users/Public/Documents/EcoWraps.xlsx"
# Get all sheet names and select the ones you want
sheet_names <- excel_sheets(excel_file) %>%
intersect(c("Initial stock", "Purchases", "Daily sales", "Stock", "Daily expenses"))
# Loop through each sheet and upload
for (sheet in sheet_names) {
cat("Uploading sheet:", sheet, "\n")
df <- read_excel(excel_file, sheet = sheet)
# Clean up sheet name for SQL table (replace spaces etc.)
table_name <- gsub(" ", "_", tolower(sheet))
# Write to PostgreSQL
dbWriteTable(con, table_name, df, overwrite = TRUE, row.names = FALSE)
}
con <- dbConnect(
RPostgres::Postgres(),
dbname = "ecowraps",
host = "localhost",
port = 5432,
user = "postgres",
password = "anyanzwa"
)
# Path to your Excel file
excel_file <- "C:/Users/Public/Documents/EcoWraps.xlsx"
# Get all sheet names and select the ones you want
sheet_names <- excel_sheets(excel_file) %>%
intersect(c("Initial stock", "Purchases", "Daily sales", "Stock", "Daily expenses"))
# Loop through each sheet and upload
for (sheet in sheet_names) {
cat("Uploading sheet:", sheet, "\n")
df <- read_excel(excel_file, sheet = sheet)
# Clean up sheet name for SQL table (replace spaces etc.)
table_name <- gsub(" ", "_", tolower(sheet))
# Write to PostgreSQL
dbWriteTable(con, table_name, df, overwrite = TRUE, row.names = FALSE)
}
cat("âœ… All sheets imported successfully!\n")
load("D:/projects/PowerBiSalesreport/R_files/.RData")
R.home("bin")
